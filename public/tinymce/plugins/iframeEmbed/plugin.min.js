


tinymce.PluginManager.add('iframeEmbed', function (editor) {
  // Function to open the dialog
  function openDialog() {
    editor.windowManager.open({
      title: `Custom Embeder`,

      body: {
        type: 'panel',
        //           name: 'url',

        // size: 40,
        items: [{
          type: 'input',
          name: 'url',
          label: 'Url',

          flex: true
        }]
      },
      onSubmit: function (e) {
        // Get the URL from the input
        const url = e.getData()?.url;
        if (e.getData().url) {

          // Create the iframe HTML
          const iframeHtml = `<iframe src="${url}" width="100%" height="300"></iframe>`;

          // Insert the iframe into the editor
          editor.insertContent(iframeHtml);
          editor.windowManager.close();
        }
      },
      // buttons: [
      //     {
      //         text: 'Close',
      //         type: 'cancel',
      //         onclick: 'close'
      //     },
      //     {
      //         text: 'Insert',
      //         type: 'submit',
      //         primary: true,
      //         enabled: false
      //     }
      // ]
      buttons: [
        {
          type: 'cancel',
          text: 'Close',
        },
        {
          type: 'submit',
          text: 'Insert',
          primary: true,
        },
      ],
    });
  }

  // Add a button to the TinyMCE toolbar
  editor.ui.registry.addButton('iframeEmbed', {
    text: 'Embed Iframe',
    icon: 'code',
    onAction: function () {
      openDialog();
    },
  });

  // Add a menu item
  editor.ui.registry.addMenuItem('iframeEmbed', {
    text: 'Embed Iframe',
    onAction: function () {
      openDialog();
    },
  });

  // Return the plugin configuration
  return {
    toolbar: 'iframeEmbed',
    menu: {
      insert: { title: 'Insert', items: 'iframeEmbed' },
    },
  };
});
